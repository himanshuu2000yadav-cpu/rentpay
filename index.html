<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>EasyRent Pay</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://checkout.razorpay.com/v1/checkout.js"></script>

<style>
body{font-family:Arial;background:#f4f8ff;margin:0}
.box{max-width:400px;margin:40px auto;background:#fff;padding:25px;border-radius:12px}
label{display:block;margin-top:12px;font-weight:600}
input{width:100%;padding:10px;margin-top:5px}
button{width:100%;margin-top:20px;padding:12px;background:#1976d2;color:#fff;border:none;border-radius:8px;font-size:16px}
</style>
</head>

<body>

<div class="box">
<h2>EasyRent Pay</h2>

<label>Payer Name</label>
<input id="payer">

<label>Mobile</label>
<input id="mobile">

<label>Beneficiary</label>
<input id="beneficiary">

<label>Amount (â‚¹)</label>
<input id="amount">

<button onclick="pay()">Pay Now</button>
</div>

<script>
function pay(){
  const amount = Number(amount.value);
  fetch("http://localhost:5000/create-order", {
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify({ amount })
  })
  .then(res=>res.json())
  .then(order=>{
    const options = {
      key: "rzp_live_S5dHw17cdqIxuk
",
      amount: order.amount,
      currency: "INR",
      order_id: order.id,
      handler: function (response) {

        fetch("http://localhost:5000/verify-payment", {
          method:"POST",
          headers:{ "Content-Type":"application/json" },
          body: JSON.stringify({
            razorpay_order_id: response.razorpay_order_id,
            razorpay_payment_id: response.razorpay_payment_id,
            razorpay_signature: response.razorpay_signature,
            payer: payer.value,
            mobile: mobile.value,
            beneficiary: beneficiary.value,
            amount: amount.value
          })
        })
        .then(r=>r.json())
        .then(data=>{
          if(data.status==="success"){
            window.open("http://localhost:5000"+data.receiptUrl,"_blank");
          }else{
            alert("Verification failed");
          }
        });
      }
    };
    new Razorpay(options).open();
  });
}
</script>

</body>
</html>
